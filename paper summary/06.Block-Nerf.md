> 先了解一些词语

> 透射率：  
> 透射率可以理解为一个点或像素的可见度，即在该点处的光线有多少能够穿过或被相机所观测到。透射率通常用[0, 1]之间的值表示，其中0表示完全不可见，1表示完全可见。在现实世界中，透射率可能受到物体的遮挡、透明度、光照等因素的影响。

# 本文中心思想
单个Nerf不能适用于大尺度的城市场景，本文将大场景划分为多个Block-Nerf，每个Block-Nerf单独训练，在推理阶段，选定几个Block-Nerf组合以生成图像，这种做法使得场景表征可以被扩展，并且可以仅改变一个或几个Block-Nerf或加入新的Block-Nerf来更新场景，而不用重新训练整个场景。
# 具体实现
## 一、训练单个Block-Nerf
### 1.Block选择
所有Block合在一起要全覆盖目标场景，通常在交叉路口放置一个Block-Nerf，能覆盖临近道路路段的75%的距离，同时保证相邻的Block-Nerf有50%的重合
### 2.外观嵌入
参考Nerf in the wild，使用Generative Latent ptimization(GLO)技术，给每张图片加一个appearance embedding(外观嵌入)，从而使得网络能够表示不同光照和天气变化，且在此基础上可以采用插值的方式来控制生成不同光照、天气状况下的环境图像。
### 3.可学习的相机pose(外参)优化
虽然假设提供了相机pose，但学习正则化的pose偏移是有利的，使用本文将pose和Nerf联合优化。
### 4.曝光信息输入
将摄像头的曝光信息输入到模型的外观预测部分，Nerf可以补偿视觉差异。
### 5.瞬态对象
尽管外观嵌入说明了外观的变化，但本文假设场景是静止的(即没有来往车辆等移动目标)，但实际情况不是这样，所以用一个语义分割模型生成常见可移动目标的Mask，并在训练期间忽略Mask区域。
### 6.能见度预测
当合并多个block-NeRF时，有一点可能很有用，即了解特定空间区域在训练期间是否对给定NeRF可见。本文用一个额外的MLP fv来扩展模型，该fv被训练来学习采样点的可见度的近似值。对于沿训练光线的每个样本，fv取3D位置和2D观察方向，并回归该点的相应透射率，fv和第一个MLP fσ一起训练。
## 二、合并多个Block-Nerf
### 1.Block-Nerf的选择
利用两种过滤机制来只渲染给定目标视点的相关Block。1)我们只考虑在目标视点的设定半径内的Block-Nerf。2)此外，对于这些候选者中的每一个，我们计算相关的可见度，如果平均可见度低于阈值，则我们丢弃该Block-NeRF。
### 2.Block-Nerf的合并
使用前一阶段经滤除而选定的blocks，根据逆距离权重（inverse distance weighting）来进行插值（interpolate），从而生成特定视角下的图像。
### 3.外观匹配
在Block-Nerf训练后，模型的外观可以由外观嵌入控制。这些嵌入在训练过程中随机初始化，因此，当输入不同Block-Nerf时，相同嵌入通常会导致不同的外观，这在合成时是不可取的，可能会导致视图之间的不一致性。给定一个Block-Nerf的目标外观，这里目的是匹配其在其余Block-Nerf的外观。具体做法是，先根据能见度，选定与相邻的几个Block-NeRF有关的特定的3D位置（3D matching location），然后固定NeRF网络参数，用L2损失来优化外观嵌入，在这一过程中，block的外观会不断变化。
> 先了解一些词语

> 体密度：  
> 体密度是指三维空间中的某个位置上，介质(如烟雾、云彩、水等)存在的密集程度，在体渲染中，体密度用于模拟光线与介质相互作用的程度，较高的体密度表示介质更加密集，光线的传播路径会被更多的散射和吸收影响。

> 隐式表达：
> ![implicit_expression](https://github.com/gjgjgjfff/Nerf_Learn/blob/main/img/Nerf/Nerf_implicit_expression.jpg)
# Nerf原理：
![Nerf_pipline](https://github.com/gjgjgjfff/Nerf_Learn/blob/main/img/Nerf/Nerf_pipline.png)
![Nerf_principle](https://github.com/gjgjgjfff/Nerf_Learn/blob/main/img/Nerf/Nerf_principle.png)
# Nerf可以分为三部分，分别是三维重建、体渲染、优化
### 一、三维重建
三维重建是指2D->3D的过程，在Nerf中输入某个点的三维坐标(x,y,z)和二维方位角($\theta \phi $)，输出该点的颜色c=(r,g,b)和体密度($\sigma$)，该部分用MLP来近似表述输入和输出关系，形成3D场景的“隐式表示”。
### 二、体渲染
渲染是指3D->2D的过程，Nerf中利用重建的3D点的颜色和体密度沿着光线进行整合得到最终的2D图像像素值。
### 三、优化
* Positional_encoding
![Positional_encoding](https://github.com/gjgjgjfff/Nerf_Learn/blob/main/img/Nerf/Nerf_Positional_encoding.png)
> 光谱误差/为什么Nerf中要用Position Encoding：  
> 一个隐式函数通常可以被分解为高频分量和低频分量，低频可能会建模场景的几何特征，高频可能会建模场景的细节，MLP的光谱误差就是说在学习高频分量的时候要比学习低频分量慢得多，所以训练相同时长，可能高频分量(图像的细节)没有被学好，从而在重建图像时出现锯齿状，在Nerf中是用Position Encoding来解决这个问题，将三维的(x,y,z)坐标映射到由sin/cos组成的频域空间，通过这种映射可以弥补MLP的光谱误差，使得它可以学到高频信息

* Hierarchical_volume_sampling
![Hierarchical_volume_sampling](https://github.com/gjgjgjfff/Nerf_Learn/blob/main/img/Nerf/Nerf_Hierarchical_volume_sampling.jpg)
# Nerf网络结构
Nerf的基本步骤：根据相机位置逐像素发射光线 → 在光线方向上进行采样获取采样点 ，对采样点进行positional encoding → 把encode后的采样点输入MLP，计算对应的（r,g,b）和体密度 → 利用volume rendering计算最终像素点的颜色。  

其中计算对应的（r,g,b）和体密度：用经过Positional_encoding的三维坐标(x,y,z)来预测体密度($\sigma$)，得到体密度和一个feature vector，feature vector和经过Positional_encoding的二维方位角($\theta \phi $)来预测(r,g,b)颜色。
![Nerf_network](https://github.com/gjgjgjfff/Nerf_Learn/blob/main/img/Nerf/Nerf_network.jpg)
